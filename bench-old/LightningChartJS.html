<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>LightningChartÂ® JS benchmark app</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="stylesheet" type="text/css" href="style.css" media="screen" />
  </head>
  <body>
    <h2 id="wait">Loading lib....</h2>

    <script src="config.iife.js"></script>
    <script src="master.iife.js"></script>
    <!-- <script src="https://unpkg.com/@arction/lcjs@3.2.0/dist/lcjs.iife.js"></script> -->
    <script>
      // LightningChart JS benchmark test implementation.

      if (! ('lcjs' in window)) {
        // Library has to be manually downloaded and put into `bench` folder.
        alert(`Library not found, refer to README Required dependencies on required files for this library.`)
      }

      let app = undefined

      const createChart = async () => {
        const {
          lightningChart,
          SolidLine,
          SolidFill,
          ColorRGBA,
          ColorHSV,
          AxisTickStrategies,
          AxisScrollStrategies,
          emptyFill,
          emptyLine,
        } = lcjs;

        const chart = lightningChart()
          .ChartXY()
          .setTitleFillStyle(emptyFill)
          .setPadding({ top: 40, bottom: 40, left: 40, right: 40 })
          .setAutoCursor((autoCursor) =>
            autoCursor.disposeTickMarkerY().setGridStrokeYStyle(emptyLine)
          );

        const xAxis = chart
          .getDefaultAxisX()
          .setTitle('Time domain')
          .setAnimationScroll(undefined)
          .setScrollStrategy(AxisScrollStrategies.progressive)
          .setInterval(-BENCHMARK_CONFIG.timeDomainInterval, 0);

        const yAxis = chart.getDefaultAxisY().setAnimationScroll(undefined);

        const series = new Array(BENCHMARK_CONFIG.channelsCount).fill(0).map((_, iChannel) => {
          const lineSeries = chart
            .addLineSeries({
              dataPattern: {
                pattern: 'ProgressiveX',
                regularProgressiveStep: true,
              }
            })
            .setName(`Channel #${iChannel + 1}`)
            .setMaxPointCount(BENCHMARK_CONFIG.timeDomainInterval)
            .setStrokeStyle(stroke => stroke.setThickness(1))
          return lineSeries
        });

        app = {
          chart,
          series,
        }
      }

      const setData = async (data) => {
        app.series.forEach((series, i) => series.clear().add(data[i]))
      }

      const appendData = async (data) => {
        app.series.forEach((series, i) => series.add(data[i]))
      }

      window.Test = {
        format: 'xy-object-array',
        createChart,
        setData,
        appendData
      }

    </script>
    <script src="benchmark.js"></script>

    <p id="reference">
      Code based on
      <a
        href="https://www.arction.com/lightningchart-js-interactive-examples/#edit/lcjs_example_0000_lineSeries"
        >https://www.arction.com/lightningchart-js-interactive-examples/#edit/lcjs_example_0000_lineSeries</a
      >
    </p>
  </body>
</html>
